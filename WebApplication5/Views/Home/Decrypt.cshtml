
@{
    ViewBag.Title = "Decrypt";
    List<string> files = new List<string>();
    string folderPath = Server.MapPath("~/Files");
    string[] filePaths = Directory.GetFiles(folderPath, "*.txt");
    List<string> CollectionFileNames = new List<string>();
    for (int i = 0; i < filePaths.Length; i++)
    {
        CollectionFileNames.Add(Path.GetFileName(filePaths[i]));
    }

    var chooseFile = Server.MapPath("~/Files/decrypt.txt");

    var result = "";
    int isReady = 0;
    Array userData1 = null;

    if (File.Exists(chooseFile))
    {
        userData1 = File.ReadAllLines(chooseFile, System.Text.Encoding.GetEncoding("windows-1251"));
        if (userData1 == null)
        {
            // Empty file.
            result = "Файл загружен, но он пуст.";
            isReady = 1;
        }
        else
        {
            result = "Файл готов к дешифровке!";
            isReady = 2;
        }
    }
    else
    {
        // File does not exist.
        result = "Файла не существует.";
        isReady = 0;
    }

}

<h2>Decrypt</h2>


<h3>Загрузите файл!</h3>
@using (Html.BeginForm("DeUpload", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <input type="file" name="deupload" />
    <br>
    <input type="submit" value="Загрузить" />


}
<h4>------------------------------------------------------------------------------------------------------------</h4>
@{
    if (isReady == 2)
    {
        <h5>
            <label>
                <img src="~/Images/ok.PNG" width="38" height="41" /> @result
            </label>
        </h5>
    }
    else if (isReady == 1)
    {
        <h5>
            <label>
                <img src="~/Images/empty.PNG" width="38" height="41" />@result , но он пуст
            </label>
        </h5>
    }
    else
    {
        <h5>
            <label>
                <img src="~/Images/false.PNG" width="38" height="41" /> Файл не загружен. Просьба его загрузить!
            </label>
        </h5>
    }
}
<h4>------------------------------------------------------------------------------------------------------------</h4>
<h5>Введите ключ:</h5>
@using (Html.BeginForm("Decrypting", "Home", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <!-- атрибут name такой же как в контроллере у метода параметр -->
        <input type="text" name="parameterName" id="ls" />

    </div>
    <br>
    <button type="submit" runat="server" id="btnLogin">Расшифровать!</button>
}

<h4>------------------------------------------------------------------------------------------------------------</h4>
<h4>Файл забрать ниже ↓</h4>
@using (Html.BeginForm("DeDownload", "Home"))
{

    <input type="submit" value="Скачать" />
}

